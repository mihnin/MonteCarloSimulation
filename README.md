![Анализ бизнес-данных с использованием метода Монте-Карло](images/titul_montecarlo.webp)

# Анализ бизнес-данных с использованием метода Монте-Карло

Это приложение представляет собой комплексный инструмент для анализа бизнес-данных с использованием метода Монте-Карло. Оно позволяет загружать данные, проводить симуляции, визуализировать результаты и сохранять анализы.

## Основные функции

1. Загрузка данных из файлов Excel, CSV или через API
2. Предварительная обработка данных
3. Проведение симуляций методом Монте-Карло
4. Визуализация результатов с помощью различных графиков
5. Сохранение и загрузка проведенных анализов
6. Экспорт результатов в Excel

## Структура приложения

- `main.py`: Основной файл приложения, содержащий интерфейс Streamlit
- `monte_carlo.py`: Реализация алгоритма Монте-Карло
- `data_processing.py`: Функции для загрузки и предобработки данных
- `visualization.py`: Функции для создания графиков
- `export_utils.py`: Утилиты для экспорта результатов
- `database.py`: Функции для работы с базой данных SQLite
- `generate_test_data.py`: Скрипт для генерации тестовых данных

## Метод Монте-Карло

Метод Монте-Карло используется для моделирования различных сценариев на основе исторических данных. В этом приложении он применяется для:

1. Симуляции будущих значений бизнес-показателей
2. Оценки рисков и неопределенностей
3. Анализа чувствительности к различным факторам

## Демонстрация прототипа

С демонстрацией прототипа можно ознакомиться по данной [ссылке](https://montecarlosimulation-kxyz9lzzdqleuhjl7qm3gc.streamlit.app/).

## Как использовать приложение

1. Запустите приложение с помощью Streamlit: `streamlit run main.py`
2. Выберите источник данных (загрузка файла, API или тестовые данные)
3. Настройте параметры симуляции (количество итераций, уровень доверия и т.д.)
4. Запустите симуляцию
5. Просмотрите результаты и графики
6. При необходимости сохраните анализ или экспортируйте результаты

## Дополнительные возможности

- Многопеременный анализ
- Учет трендов и сезонности
- Применение пользовательских распределений
- Анализ чувствительности
- Учет внешних факторов

## Технические требования

- Python 3.7+
- Streamlit
- Pandas
- NumPy
- Plotly
- SQLite

## Установка и запуск

1. Клонируйте репозиторий
2. Установите зависимости: `pip install -r requirements.txt`
3. Запустите приложение: `streamlit run main.py`

## Примечание

Это приложение предназначено для анализа бизнес-данных и помощи в принятии решений. Однако помните, что результаты симуляций основаны на исторических данных и предположениях, и не гарантируют точного предсказания будущих событий.

# Дополнительно

## Описание приложения

Это веб-приложение, разработанное с использованием Streamlit, предназначено для анализа бизнес-данных с помощью метода Монте-Карло. Оно позволяет загружать данные, проводить симуляции и визуализировать результаты.

## Входные данные

Приложение принимает файлы в формате Excel (.xlsx, .xls) или CSV. Набор данных должен содержать следующие поля:

1. Дата (обязательное поле): дата каждой записи
2. Продажи (обязательное поле): числовое значение, представляющее объем продаж
3. Расходы (обязательное поле): числовое значение, представляющее расходы
4. Прибыль (необязательное поле): если не указано, будет рассчитано как Продажи - Расходы

Пример структуры данных:

| Дата       | Продажи | Расходы | Прибыль |
|------------|---------|---------|---------|
| 2023-01-01 | 1000    | 800     | 200     |
| 2023-01-02 | 1200    | 900     | 300     |
| ...        | ...     | ...     | ...     |

## Метод Монте-Карло на примере яблок

Представьте, что вы владелец яблочного сада. Вы хотите спрогнозировать урожай на следующий год, но на него влияет множество факторов: погода, вредители, качество почвы и т.д.

Метод Монте-Карло позволяет учесть эту неопределенность:

1. Вы определяете диапазон возможных значений для каждого фактора (например, количество дождливых дней от 30 до 60).
2. Проводите тысячи симуляций, каждый раз случайно выбирая значения из этих диапазонов.
3. Для каждой симуляции рассчитываете предполагаемый урожай.
4. Анализируете результаты всех симуляций, чтобы получить вероятностное распределение урожая.

Это дает вам не просто одно число, а диапазон возможных результатов с их вероятностями, что помогает лучше подготовиться к различным сценариям.

## Бизнес-выгоды использования метода Монте-Карло

1. Улучшенное управление рисками: понимание вероятности различных исходов помогает лучше подготовиться к неопределенностям.
2. Более информированное принятие решений: вместо опоры на единственный прогноз, вы видите спектр возможных результатов.
3. Оптимизация ресурсов: зная вероятности различных сценариев, можно эффективнее распределять ресурсы.
4. Повышение точности прогнозов: учет множества факторов и их взаимодействий дает более реалистичные прогнозы.
5. Сценарное планирование: возможность анализировать множество "что если" сценариев.

## API подключение

Для подключения к приложению из других Python-приложений можно использовать библиотеку requests. Вот пример отправки данных и получения результатов:

```python
import requests
import pandas as pd
import json

# Подготовка данных
data = pd.DataFrame({
    'Date': ['2023-01-01', '2023-01-02', '2023-01-03'],
    'Sales': [1000, 1200, 1100],
    'Expenses': [800, 900, 850]
})

# Преобразование данных в JSON
json_data = data.to_json(orient='records')

# Отправка запроса
url = 'http://your-app-url/api/simulate'
response = requests.post(url, json=json_data)

# Получение результатов
results = response.json()

print(results)
```

Результаты будут возвращены в формате JSON, например:

```json
{
    "mean": 250.5,
    "median": 248.3,
    "std": 15.2,
    "ci_lower": 220.1,
    "ci_upper": 280.9,
    "simulated_data": [245.6, 252.3, 248.9, ...]
}
```

Обратите внимание, что для использования API необходимо реализовать соответствующий эндпоинт в приложении, который в данный момент отсутствует и может быть добавлен в будущих обновлениях.
